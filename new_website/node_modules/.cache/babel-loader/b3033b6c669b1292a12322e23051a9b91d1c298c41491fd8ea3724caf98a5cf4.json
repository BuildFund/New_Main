{"ast":null,"code":"import React,{useState,useEffect}from'react';import{Navigate}from'react-router-dom';import Layout from'../components/Layout';import BorrowerDashboard from'./BorrowerDashboard';import LenderDashboard from'./LenderDashboard';import AdminDashboard from'./AdminDashboard';import Chatbot from'../components/Chatbot';import api from'../api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Dashboard(_ref){let{role,onLogout}=_ref;const[showChatbot,setShowChatbot]=useState(false);const[onboardingProgress,setOnboardingProgress]=useState(null);useEffect(()=>{checkOnboardingProgress();},[]);async function checkOnboardingProgress(){try{const res=await api.get('/api/onboarding/progress/');setOnboardingProgress(res.data);// Show chatbot if onboarding is not complete\n// This works for both Borrower and Lender roles\nif(!res.data.is_complete&&res.data.completion_percentage<100){// Show after a short delay to not be intrusive\nsetTimeout(()=>{setShowChatbot(true);},3000);}}catch(err){console.error('Failed to check onboarding progress:',err);// If progress check fails, still allow manual chatbot trigger\n}}function handleChatbotComplete(){setShowChatbot(false);checkOnboardingProgress();}const dashboardContent=(()=>{if(role==='Borrower'){return/*#__PURE__*/_jsx(BorrowerDashboard,{onboardingProgress:onboardingProgress,onStartOnboarding:()=>setShowChatbot(true)});}if(role==='Lender'){return/*#__PURE__*/_jsx(LenderDashboard,{onboardingProgress:onboardingProgress,onStartOnboarding:()=>setShowChatbot(true)});}if(role==='Admin'){return/*#__PURE__*/_jsx(AdminDashboard,{});}if(role==='Consultant'){return/*#__PURE__*/_jsx(Navigate,{to:\"/consultant/dashboard\"});}// Fallback for unknown roles\nreturn/*#__PURE__*/_jsxs(\"div\",{style:{padding:'1rem'},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Dashboard\"}),/*#__PURE__*/_jsxs(\"p\",{children:[\"You are logged in as \",/*#__PURE__*/_jsx(\"strong\",{children:role||'User'}),\".\"]})]});})();return/*#__PURE__*/_jsxs(Layout,{role:role,onLogout:onLogout,children:[dashboardContent,showChatbot&&/*#__PURE__*/_jsx(Chatbot,{onComplete:handleChatbotComplete,onClose:()=>setShowChatbot(false)})]});}export default Dashboard;","map":{"version":3,"names":["React","useState","useEffect","Navigate","Layout","BorrowerDashboard","LenderDashboard","AdminDashboard","Chatbot","api","jsx","_jsx","jsxs","_jsxs","Dashboard","_ref","role","onLogout","showChatbot","setShowChatbot","onboardingProgress","setOnboardingProgress","checkOnboardingProgress","res","get","data","is_complete","completion_percentage","setTimeout","err","console","error","handleChatbotComplete","dashboardContent","onStartOnboarding","to","style","padding","children","onComplete","onClose"],"sources":["C:/Users/paul-/OneDrive - BARE Capital Ltd/BARE Drive/10.0 BUILDFUND/1.0 Website Dev/GitHub/new_website/src/pages/Dashboard.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Navigate } from 'react-router-dom';\r\nimport Layout from '../components/Layout';\r\nimport BorrowerDashboard from './BorrowerDashboard';\r\nimport LenderDashboard from './LenderDashboard';\r\nimport AdminDashboard from './AdminDashboard';\r\nimport Chatbot from '../components/Chatbot';\r\nimport api from '../api';\r\n\r\nfunction Dashboard({ role, onLogout }) {\r\n  const [showChatbot, setShowChatbot] = useState(false);\r\n  const [onboardingProgress, setOnboardingProgress] = useState(null);\r\n\r\n  useEffect(() => {\r\n    checkOnboardingProgress();\r\n  }, []);\r\n\r\n  async function checkOnboardingProgress() {\r\n    try {\r\n      const res = await api.get('/api/onboarding/progress/');\r\n      setOnboardingProgress(res.data);\r\n      \r\n      // Show chatbot if onboarding is not complete\r\n      // This works for both Borrower and Lender roles\r\n      if (!res.data.is_complete && res.data.completion_percentage < 100) {\r\n        // Show after a short delay to not be intrusive\r\n        setTimeout(() => {\r\n          setShowChatbot(true);\r\n        }, 3000);\r\n      }\r\n    } catch (err) {\r\n      console.error('Failed to check onboarding progress:', err);\r\n      // If progress check fails, still allow manual chatbot trigger\r\n    }\r\n  }\r\n\r\n  function handleChatbotComplete() {\r\n    setShowChatbot(false);\r\n    checkOnboardingProgress();\r\n  }\r\n\r\n  const dashboardContent = (() => {\r\n    if (role === 'Borrower') {\r\n      return <BorrowerDashboard onboardingProgress={onboardingProgress} onStartOnboarding={() => setShowChatbot(true)} />;\r\n    }\r\n    if (role === 'Lender') {\r\n      return <LenderDashboard onboardingProgress={onboardingProgress} onStartOnboarding={() => setShowChatbot(true)} />;\r\n    }\r\n    if (role === 'Admin') {\r\n      return <AdminDashboard />;\r\n    }\r\n    if (role === 'Consultant') {\r\n      return <Navigate to=\"/consultant/dashboard\" />;\r\n    }\r\n    \r\n    // Fallback for unknown roles\r\n    return (\r\n      <div style={{ padding: '1rem' }}>\r\n        <h2>Dashboard</h2>\r\n        <p>You are logged in as <strong>{role || 'User'}</strong>.</p>\r\n      </div>\r\n    );\r\n  })();\r\n\r\n  return (\r\n    <Layout role={role} onLogout={onLogout}>\r\n      {dashboardContent}\r\n      {showChatbot && (\r\n        <Chatbot\r\n          onComplete={handleChatbotComplete}\r\n          onClose={() => setShowChatbot(false)}\r\n        />\r\n      )}\r\n    </Layout>\r\n  );\r\n}\r\n\r\nexport default Dashboard;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}