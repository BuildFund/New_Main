{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import api from'../api';import{theme,commonStyles}from'../styles/theme';import Button from'./Button';import Input from'./Input';import Badge from'./Badge';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";function Chatbot(_ref){let{onComplete,onClose}=_ref;const[messages,setMessages]=useState([]);const[currentQuestion,setCurrentQuestion]=useState(null);const[sessionId,setSessionId]=useState(null);const[progress,setProgress]=useState({completion_percentage:0});const[inputValue,setInputValue]=useState('');const[loading,setLoading]=useState(true);const[uploading,setUploading]=useState(false);const[dragActive,setDragActive]=useState(false);const messagesEndRef=useRef(null);const fileInputRef=useRef(null);useEffect(()=>{startConversation();},[]);useEffect(()=>{scrollToBottom();},[messages]);async function startConversation(){setLoading(true);try{const res=await api.get('/api/onboarding/chat/');setSessionId(res.data.session_id);setCurrentQuestion(res.data.question);setProgress(res.data.progress);// Use conversation history from backend (includes welcome back message if resuming)\nif(res.data.conversation_history&&res.data.conversation_history.length>0){var _res$data$question;const messages=[...res.data.conversation_history];const isResuming=res.data.is_resuming;// If resuming, ensure the current question is shown (it might not be in history yet)\nif(isResuming&&(_res$data$question=res.data.question)!==null&&_res$data$question!==void 0&&_res$data$question.question){// Check if the last bot message is the current question\nconst lastBotMessage=[...messages].reverse().find(msg=>msg.type==='bot');const questionAlreadyShown=lastBotMessage&&lastBotMessage.message===res.data.question.question;if(!questionAlreadyShown){// Add the current question as the latest bot message so user knows what to answer\nmessages.push({type:'bot',message:res.data.question.question,timestamp:new Date().toISOString()});}}setMessages(messages);}else{var _res$data$question2;// New conversation - add welcome message\nsetMessages([{type:'bot',message:((_res$data$question2=res.data.question)===null||_res$data$question2===void 0?void 0:_res$data$question2.question)||'Welcome! Let\\'s get started.',timestamp:new Date().toISOString()}]);}}catch(err){var _err$response,_err$response$data,_err$response2,_err$response2$data;console.error('Failed to start conversation:',err);const errorMessage=((_err$response=err.response)===null||_err$response===void 0?void 0:(_err$response$data=_err$response.data)===null||_err$response$data===void 0?void 0:_err$response$data.error)||((_err$response2=err.response)===null||_err$response2===void 0?void 0:(_err$response2$data=_err$response2.data)===null||_err$response2$data===void 0?void 0:_err$response2$data.detail)||err.message||'Failed to start conversation. Please try again.';setMessages([{type:'bot',message:\"Sorry, I encountered an error: \".concat(errorMessage,\". Please refresh the page and try again.\"),timestamp:new Date().toISOString()}]);}finally{setLoading(false);}}async function sendMessage(message){let step=arguments.length>1&&arguments[1]!==undefined?arguments[1]:null;if(!message.trim()&&!step)return;// Add user message to chat\nconst userMessage={type:'user',message:message||(step==='file_upload'?'Files uploaded':''),timestamp:new Date().toISOString()};setMessages(prev=>[...prev,userMessage]);try{var _res$data$question3,_res$data$progress;const res=await api.post('/api/onboarding/chat/',{message:message||'',step:step||(currentQuestion===null||currentQuestion===void 0?void 0:currentQuestion.step),session_id:sessionId});setCurrentQuestion(res.data.question);setProgress(res.data.progress);// Add bot response with progress indicator\nif((_res$data$question3=res.data.question)!==null&&_res$data$question3!==void 0&&_res$data$question3.question){const questionText=res.data.question.question;const progressInfo=res.data.question.progress!==undefined?\"\\n\\n\\uD83D\\uDCCA Progress: \".concat(res.data.question.progress,\"% complete (Step \").concat(res.data.question.step_number||'',\" of \").concat(res.data.question.total_steps||'',\")\"):'';setMessages(prev=>[...prev,{type:'bot',message:questionText+progressInfo,timestamp:new Date().toISOString()}]);}// Check if complete\nif((_res$data$progress=res.data.progress)!==null&&_res$data$progress!==void 0&&_res$data$progress.is_complete){setTimeout(()=>{if(onComplete)onComplete();},2000);}}catch(err){var _err$response3,_err$response3$data,_err$response4,_err$response4$data;console.error('Failed to send message:',err);const errorMessage=((_err$response3=err.response)===null||_err$response3===void 0?void 0:(_err$response3$data=_err$response3.data)===null||_err$response3$data===void 0?void 0:_err$response3$data.error)||((_err$response4=err.response)===null||_err$response4===void 0?void 0:(_err$response4$data=_err$response4.data)===null||_err$response4$data===void 0?void 0:_err$response4$data.detail)||err.message||'An error occurred';setMessages(prev=>[...prev,{type:'bot',message:\"Sorry, I encountered an error: \".concat(errorMessage,\". Please try again.\"),timestamp:new Date().toISOString()}]);}}function handleSubmit(e){e.preventDefault();if(!inputValue.trim()&&(currentQuestion===null||currentQuestion===void 0?void 0:currentQuestion.type)!=='file')return;sendMessage(inputValue);setInputValue('');}function handleOptionSelect(option){sendMessage(option);}function handleFileUpload(files){if(!files||files.length===0)return;setUploading(true);const formData=new FormData();Array.from(files).forEach(file=>{formData.append('files',file);});// Upload files to onboarding documents API\napi.post('/api/onboarding/upload_documents/',formData,{headers:{'Content-Type':'multipart/form-data'}}).then(res=>{var _res$data$documents;const uploadedCount=((_res$data$documents=res.data.documents)===null||_res$data$documents===void 0?void 0:_res$data$documents.length)||files.length;const docStatus=res.data.document_status;// Add success message\nsetMessages(prev=>[...prev,{type:'user',message:\"Uploaded \".concat(uploadedCount,\" file(s)\"),timestamp:new Date().toISOString()}]);// Check if all documents are uploaded\nif(docStatus&&docStatus.all_uploaded){setMessages(prev=>[...prev,{type:'bot',message:'âœ… Excellent! All required documents have been uploaded. You can now proceed to review your application.',timestamp:new Date().toISOString()}]);// Refresh to get updated question\nsetTimeout(()=>{sendMessage('All documents uploaded',currentQuestion===null||currentQuestion===void 0?void 0:currentQuestion.step);},1000);}else{var _docStatus$missing_do;// Still missing documents\nconst missingCount=(docStatus===null||docStatus===void 0?void 0:(_docStatus$missing_do=docStatus.missing_documents)===null||_docStatus$missing_do===void 0?void 0:_docStatus$missing_do.length)||0;setMessages(prev=>[...prev,{type:'bot',message:\"\\u2705 Files uploaded successfully! However, you still need to upload \".concat(missingCount,\" more required document(s). Please continue uploading the remaining documents.\"),timestamp:new Date().toISOString()}]);// Refresh to get updated question showing what's still needed\nsetTimeout(()=>{sendMessage('Continue',currentQuestion===null||currentQuestion===void 0?void 0:currentQuestion.step);},1000);}setUploading(false);}).catch(err=>{var _err$response5,_err$response5$data,_err$response6,_err$response6$data;console.error('File upload failed:',err);const errorMessage=((_err$response5=err.response)===null||_err$response5===void 0?void 0:(_err$response5$data=_err$response5.data)===null||_err$response5$data===void 0?void 0:_err$response5$data.error)||((_err$response6=err.response)===null||_err$response6===void 0?void 0:(_err$response6$data=_err$response6.data)===null||_err$response6$data===void 0?void 0:_err$response6$data.detail)||err.message||'File upload failed';setMessages(prev=>[...prev,{type:'bot',message:\"Sorry, file upload failed: \".concat(errorMessage,\". Please try again.\"),timestamp:new Date().toISOString()}]);setUploading(false);});}function handleDrag(e){e.preventDefault();e.stopPropagation();if(e.type==='dragenter'||e.type==='dragover'){setDragActive(true);}else if(e.type==='dragleave'){setDragActive(false);}}function handleDrop(e){e.preventDefault();e.stopPropagation();setDragActive(false);if(e.dataTransfer.files&&e.dataTransfer.files.length>0){handleFileUpload(e.dataTransfer.files);}}function scrollToBottom(){var _messagesEndRef$curre;(_messagesEndRef$curre=messagesEndRef.current)===null||_messagesEndRef$curre===void 0?void 0:_messagesEndRef$curre.scrollIntoView({behavior:'smooth'});}const questionType=currentQuestion===null||currentQuestion===void 0?void 0:currentQuestion.type;const showFileUpload=questionType==='file';return/*#__PURE__*/_jsxs(\"div\",{style:{position:'fixed',bottom:'20px',right:'20px',width:'400px',maxHeight:'600px',background:theme.colors.white,borderRadius:theme.borderRadius.lg,boxShadow:theme.shadows.xl,display:'flex',flexDirection:'column',zIndex:1000,border:\"1px solid \".concat(theme.colors.gray200)},children:[/*#__PURE__*/_jsxs(\"div\",{style:{padding:theme.spacing.md,borderBottom:\"1px solid \".concat(theme.colors.gray200),display:'flex',justifyContent:'space-between',alignItems:'center',background:theme.colors.primary,color:theme.colors.white,borderRadius:\"\".concat(theme.borderRadius.lg,\" \").concat(theme.borderRadius.lg,\" 0 0\")},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h3\",{style:{margin:0,fontSize:theme.typography.fontSize.lg},children:\"BuildFund Assistant \\uD83E\\uDD16\"}),progress.completion_percentage>0&&/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:theme.typography.fontSize.xs,marginTop:theme.spacing.xs},children:[progress.completion_percentage,\"% Complete\"]})]}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,style:{background:'transparent',border:'none',color:theme.colors.white,fontSize:'20px',cursor:'pointer',padding:theme.spacing.xs},children:\"\\xD7\"})]}),progress.completion_percentage>0&&/*#__PURE__*/_jsx(\"div\",{style:{height:'4px',background:theme.colors.gray200,width:'100%'},children:/*#__PURE__*/_jsx(\"div\",{style:{height:'100%',background:theme.colors.primary,width:\"\".concat(progress.completion_percentage,\"%\"),transition:'width 0.3s ease'}})}),/*#__PURE__*/_jsx(\"div\",{style:{flex:1,overflowY:'auto',padding:theme.spacing.md,display:'flex',flexDirection:'column',gap:theme.spacing.md,minHeight:'300px',maxHeight:'400px'},children:loading?/*#__PURE__*/_jsx(\"div\",{style:{textAlign:'center',color:theme.colors.textSecondary},children:\"Loading...\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[messages.map((msg,idx)=>/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',justifyContent:msg.type==='user'?'flex-end':'flex-start'},children:/*#__PURE__*/_jsx(\"div\",{style:{maxWidth:'80%',padding:theme.spacing.sm,borderRadius:theme.borderRadius.md,background:msg.type==='user'?theme.colors.primary:theme.colors.gray100,color:msg.type==='user'?theme.colors.white:theme.colors.textPrimary,fontSize:theme.typography.fontSize.sm},children:msg.message})},idx)),/*#__PURE__*/_jsx(\"div\",{ref:messagesEndRef})]})}),showFileUpload&&/*#__PURE__*/_jsxs(\"div\",{onDragEnter:handleDrag,onDragLeave:handleDrag,onDragOver:handleDrag,onDrop:handleDrop,style:{margin:theme.spacing.md,padding:theme.spacing.lg,border:\"2px dashed \".concat(dragActive?theme.colors.primary:theme.colors.gray300),borderRadius:theme.borderRadius.md,textAlign:'center',background:dragActive?theme.colors.primaryLight:theme.colors.gray50,cursor:'pointer',transition:\"all \".concat(theme.transitions.fast)},onClick:()=>{var _fileInputRef$current;return(_fileInputRef$current=fileInputRef.current)===null||_fileInputRef$current===void 0?void 0:_fileInputRef$current.click();},children:[/*#__PURE__*/_jsx(\"input\",{ref:fileInputRef,type:\"file\",multiple:true,style:{display:'none'},onChange:e=>handleFileUpload(e.target.files)}),/*#__PURE__*/_jsx(\"div\",{style:{fontSize:'24px',marginBottom:theme.spacing.sm},children:\"\\uD83D\\uDCCE\"}),/*#__PURE__*/_jsx(\"div\",{style:{color:theme.colors.textSecondary,fontSize:theme.typography.fontSize.sm},children:\"Drag and drop files here or click to browse\"})]}),!showFileUpload&&currentQuestion&&/*#__PURE__*/_jsx(\"div\",{style:{padding:theme.spacing.md,borderTop:\"1px solid \".concat(theme.colors.gray200)},children:currentQuestion.type==='select'&&currentQuestion.options?/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',flexDirection:'column',gap:theme.spacing.xs},children:currentQuestion.options.map((option,idx)=>/*#__PURE__*/_jsx(Button,{variant:\"outline\",size:\"sm\",onClick:()=>handleOptionSelect(option),style:{width:'100%',textAlign:'left'},children:option},idx))}):/*#__PURE__*/_jsx(\"form\",{onSubmit:handleSubmit,children:/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:theme.spacing.sm},children:[/*#__PURE__*/_jsx(\"input\",{type:currentQuestion.type==='date'?'date':currentQuestion.type==='number'?'number':'text',value:inputValue,onChange:e=>setInputValue(e.target.value),placeholder:currentQuestion.type==='date'?'DD/MM/YYYY':'Type your answer...',style:{flex:1,padding:theme.spacing.sm,border:\"1px solid \".concat(theme.colors.gray300),borderRadius:theme.borderRadius.md,fontSize:theme.typography.fontSize.sm},required:currentQuestion.required}),/*#__PURE__*/_jsx(Button,{type:\"submit\",variant:\"primary\",size:\"sm\",children:\"Send\"})]})})}),uploading&&/*#__PURE__*/_jsx(\"div\",{style:{padding:theme.spacing.sm,textAlign:'center',color:theme.colors.textSecondary,fontSize:theme.typography.fontSize.sm},children:\"Uploading files...\"})]});}export default Chatbot;","map":{"version":3,"names":["React","useState","useEffect","useRef","api","theme","commonStyles","Button","Input","Badge","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Chatbot","_ref","onComplete","onClose","messages","setMessages","currentQuestion","setCurrentQuestion","sessionId","setSessionId","progress","setProgress","completion_percentage","inputValue","setInputValue","loading","setLoading","uploading","setUploading","dragActive","setDragActive","messagesEndRef","fileInputRef","startConversation","scrollToBottom","res","get","data","session_id","question","conversation_history","length","_res$data$question","isResuming","is_resuming","lastBotMessage","reverse","find","msg","type","questionAlreadyShown","message","push","timestamp","Date","toISOString","_res$data$question2","err","_err$response","_err$response$data","_err$response2","_err$response2$data","console","error","errorMessage","response","detail","concat","sendMessage","step","arguments","undefined","trim","userMessage","prev","_res$data$question3","_res$data$progress","post","questionText","progressInfo","step_number","total_steps","is_complete","setTimeout","_err$response3","_err$response3$data","_err$response4","_err$response4$data","handleSubmit","e","preventDefault","handleOptionSelect","option","handleFileUpload","files","formData","FormData","Array","from","forEach","file","append","headers","then","_res$data$documents","uploadedCount","documents","docStatus","document_status","all_uploaded","_docStatus$missing_do","missingCount","missing_documents","catch","_err$response5","_err$response5$data","_err$response6","_err$response6$data","handleDrag","stopPropagation","handleDrop","dataTransfer","_messagesEndRef$curre","current","scrollIntoView","behavior","questionType","showFileUpload","style","position","bottom","right","width","maxHeight","background","colors","white","borderRadius","lg","boxShadow","shadows","xl","display","flexDirection","zIndex","border","gray200","children","padding","spacing","md","borderBottom","justifyContent","alignItems","primary","color","margin","fontSize","typography","xs","marginTop","onClick","cursor","height","transition","flex","overflowY","gap","minHeight","textAlign","textSecondary","map","idx","maxWidth","sm","gray100","textPrimary","ref","onDragEnter","onDragLeave","onDragOver","onDrop","gray300","primaryLight","gray50","transitions","fast","_fileInputRef$current","click","multiple","onChange","target","marginBottom","borderTop","options","variant","size","onSubmit","value","placeholder","required"],"sources":["C:/Users/paul-/OneDrive - BARE Capital Ltd/BARE Drive/10.0 BUILDFUND/1.0 Website Dev/GitHub/new_website/src/components/Chatbot.js"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\r\nimport api from '../api';\r\nimport { theme, commonStyles } from '../styles/theme';\r\nimport Button from './Button';\r\nimport Input from './Input';\r\nimport Badge from './Badge';\r\n\r\nfunction Chatbot({ onComplete, onClose }) {\r\n  const [messages, setMessages] = useState([]);\r\n  const [currentQuestion, setCurrentQuestion] = useState(null);\r\n  const [sessionId, setSessionId] = useState(null);\r\n  const [progress, setProgress] = useState({ completion_percentage: 0 });\r\n  const [inputValue, setInputValue] = useState('');\r\n  const [loading, setLoading] = useState(true);\r\n  const [uploading, setUploading] = useState(false);\r\n  const [dragActive, setDragActive] = useState(false);\r\n  const messagesEndRef = useRef(null);\r\n  const fileInputRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    startConversation();\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n    scrollToBottom();\r\n  }, [messages]);\r\n\r\n  async function startConversation() {\r\n    setLoading(true);\r\n    try {\r\n      const res = await api.get('/api/onboarding/chat/');\r\n      setSessionId(res.data.session_id);\r\n      setCurrentQuestion(res.data.question);\r\n      setProgress(res.data.progress);\r\n      \r\n      // Use conversation history from backend (includes welcome back message if resuming)\r\n      if (res.data.conversation_history && res.data.conversation_history.length > 0) {\r\n        const messages = [...res.data.conversation_history];\r\n        const isResuming = res.data.is_resuming;\r\n        \r\n        // If resuming, ensure the current question is shown (it might not be in history yet)\r\n        if (isResuming && res.data.question?.question) {\r\n          // Check if the last bot message is the current question\r\n          const lastBotMessage = [...messages].reverse().find(msg => msg.type === 'bot');\r\n          const questionAlreadyShown = lastBotMessage && lastBotMessage.message === res.data.question.question;\r\n          \r\n          if (!questionAlreadyShown) {\r\n            // Add the current question as the latest bot message so user knows what to answer\r\n            messages.push({\r\n              type: 'bot',\r\n              message: res.data.question.question,\r\n              timestamp: new Date().toISOString(),\r\n            });\r\n          }\r\n        }\r\n        \r\n        setMessages(messages);\r\n      } else {\r\n        // New conversation - add welcome message\r\n        setMessages([{\r\n          type: 'bot',\r\n          message: res.data.question?.question || 'Welcome! Let\\'s get started.',\r\n          timestamp: new Date().toISOString(),\r\n        }]);\r\n      }\r\n    } catch (err) {\r\n      console.error('Failed to start conversation:', err);\r\n      const errorMessage = err.response?.data?.error || err.response?.data?.detail || err.message || 'Failed to start conversation. Please try again.';\r\n      setMessages([{\r\n        type: 'bot',\r\n        message: `Sorry, I encountered an error: ${errorMessage}. Please refresh the page and try again.`,\r\n        timestamp: new Date().toISOString(),\r\n      }]);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  async function sendMessage(message, step = null) {\r\n    if (!message.trim() && !step) return;\r\n\r\n    // Add user message to chat\r\n    const userMessage = {\r\n      type: 'user',\r\n      message: message || (step === 'file_upload' ? 'Files uploaded' : ''),\r\n      timestamp: new Date().toISOString(),\r\n    };\r\n    setMessages(prev => [...prev, userMessage]);\r\n\r\n    try {\r\n      const res = await api.post('/api/onboarding/chat/', {\r\n        message: message || '',\r\n        step: step || currentQuestion?.step,\r\n        session_id: sessionId,\r\n      });\r\n\r\n      setCurrentQuestion(res.data.question);\r\n      setProgress(res.data.progress);\r\n      \r\n      // Add bot response with progress indicator\r\n      if (res.data.question?.question) {\r\n        const questionText = res.data.question.question;\r\n        const progressInfo = res.data.question.progress !== undefined \r\n          ? `\\n\\nðŸ“Š Progress: ${res.data.question.progress}% complete (Step ${res.data.question.step_number || ''} of ${res.data.question.total_steps || ''})`\r\n          : '';\r\n        \r\n        setMessages(prev => [...prev, {\r\n          type: 'bot',\r\n          message: questionText + progressInfo,\r\n          timestamp: new Date().toISOString(),\r\n        }]);\r\n      }\r\n\r\n      // Check if complete\r\n      if (res.data.progress?.is_complete) {\r\n        setTimeout(() => {\r\n          if (onComplete) onComplete();\r\n        }, 2000);\r\n      }\r\n    } catch (err) {\r\n      console.error('Failed to send message:', err);\r\n      const errorMessage = err.response?.data?.error || err.response?.data?.detail || err.message || 'An error occurred';\r\n      setMessages(prev => [...prev, {\r\n        type: 'bot',\r\n        message: `Sorry, I encountered an error: ${errorMessage}. Please try again.`,\r\n        timestamp: new Date().toISOString(),\r\n      }]);\r\n    }\r\n  }\r\n\r\n  function handleSubmit(e) {\r\n    e.preventDefault();\r\n    if (!inputValue.trim() && currentQuestion?.type !== 'file') return;\r\n    \r\n    sendMessage(inputValue);\r\n    setInputValue('');\r\n  }\r\n\r\n  function handleOptionSelect(option) {\r\n    sendMessage(option);\r\n  }\r\n\r\n  function handleFileUpload(files) {\r\n    if (!files || files.length === 0) return;\r\n\r\n    setUploading(true);\r\n    const formData = new FormData();\r\n    Array.from(files).forEach(file => {\r\n      formData.append('files', file);\r\n    });\r\n\r\n    // Upload files to onboarding documents API\r\n    api.post('/api/onboarding/upload_documents/', formData, {\r\n      headers: { \r\n        'Content-Type': 'multipart/form-data',\r\n      },\r\n    })\r\n      .then((res) => {\r\n        const uploadedCount = res.data.documents?.length || files.length;\r\n        const docStatus = res.data.document_status;\r\n        \r\n        // Add success message\r\n        setMessages(prev => [...prev, {\r\n          type: 'user',\r\n          message: `Uploaded ${uploadedCount} file(s)`,\r\n          timestamp: new Date().toISOString(),\r\n        }]);\r\n        \r\n        // Check if all documents are uploaded\r\n        if (docStatus && docStatus.all_uploaded) {\r\n          setMessages(prev => [...prev, {\r\n            type: 'bot',\r\n            message: 'âœ… Excellent! All required documents have been uploaded. You can now proceed to review your application.',\r\n            timestamp: new Date().toISOString(),\r\n          }]);\r\n          // Refresh to get updated question\r\n          setTimeout(() => {\r\n            sendMessage('All documents uploaded', currentQuestion?.step);\r\n          }, 1000);\r\n        } else {\r\n          // Still missing documents\r\n          const missingCount = docStatus?.missing_documents?.length || 0;\r\n          setMessages(prev => [...prev, {\r\n            type: 'bot',\r\n            message: `âœ… Files uploaded successfully! However, you still need to upload ${missingCount} more required document(s). Please continue uploading the remaining documents.`,\r\n            timestamp: new Date().toISOString(),\r\n          }]);\r\n          // Refresh to get updated question showing what's still needed\r\n          setTimeout(() => {\r\n            sendMessage('Continue', currentQuestion?.step);\r\n          }, 1000);\r\n        }\r\n        \r\n        setUploading(false);\r\n      })\r\n      .catch(err => {\r\n        console.error('File upload failed:', err);\r\n        const errorMessage = err.response?.data?.error || err.response?.data?.detail || err.message || 'File upload failed';\r\n        setMessages(prev => [...prev, {\r\n          type: 'bot',\r\n          message: `Sorry, file upload failed: ${errorMessage}. Please try again.`,\r\n          timestamp: new Date().toISOString(),\r\n        }]);\r\n        setUploading(false);\r\n      });\r\n  }\r\n\r\n  function handleDrag(e) {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    if (e.type === 'dragenter' || e.type === 'dragover') {\r\n      setDragActive(true);\r\n    } else if (e.type === 'dragleave') {\r\n      setDragActive(false);\r\n    }\r\n  }\r\n\r\n  function handleDrop(e) {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    setDragActive(false);\r\n    \r\n    if (e.dataTransfer.files && e.dataTransfer.files.length > 0) {\r\n      handleFileUpload(e.dataTransfer.files);\r\n    }\r\n  }\r\n\r\n  function scrollToBottom() {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });\r\n  }\r\n\r\n  const questionType = currentQuestion?.type;\r\n  const showFileUpload = questionType === 'file';\r\n\r\n  return (\r\n    <div style={{\r\n      position: 'fixed',\r\n      bottom: '20px',\r\n      right: '20px',\r\n      width: '400px',\r\n      maxHeight: '600px',\r\n      background: theme.colors.white,\r\n      borderRadius: theme.borderRadius.lg,\r\n      boxShadow: theme.shadows.xl,\r\n      display: 'flex',\r\n      flexDirection: 'column',\r\n      zIndex: 1000,\r\n      border: `1px solid ${theme.colors.gray200}`,\r\n    }}>\r\n      {/* Header */}\r\n      <div style={{\r\n        padding: theme.spacing.md,\r\n        borderBottom: `1px solid ${theme.colors.gray200}`,\r\n        display: 'flex',\r\n        justifyContent: 'space-between',\r\n        alignItems: 'center',\r\n        background: theme.colors.primary,\r\n        color: theme.colors.white,\r\n        borderRadius: `${theme.borderRadius.lg} ${theme.borderRadius.lg} 0 0`,\r\n      }}>\r\n        <div>\r\n          <h3 style={{ margin: 0, fontSize: theme.typography.fontSize.lg }}>\r\n            BuildFund Assistant ðŸ¤–\r\n          </h3>\r\n          {progress.completion_percentage > 0 && (\r\n            <div style={{ fontSize: theme.typography.fontSize.xs, marginTop: theme.spacing.xs }}>\r\n              {progress.completion_percentage}% Complete\r\n            </div>\r\n          )}\r\n        </div>\r\n        <button\r\n          onClick={onClose}\r\n          style={{\r\n            background: 'transparent',\r\n            border: 'none',\r\n            color: theme.colors.white,\r\n            fontSize: '20px',\r\n            cursor: 'pointer',\r\n            padding: theme.spacing.xs,\r\n          }}\r\n        >\r\n          Ã—\r\n        </button>\r\n      </div>\r\n\r\n      {/* Progress Bar */}\r\n      {progress.completion_percentage > 0 && (\r\n        <div style={{\r\n          height: '4px',\r\n          background: theme.colors.gray200,\r\n          width: '100%',\r\n        }}>\r\n          <div style={{\r\n            height: '100%',\r\n            background: theme.colors.primary,\r\n            width: `${progress.completion_percentage}%`,\r\n            transition: 'width 0.3s ease',\r\n          }} />\r\n        </div>\r\n      )}\r\n\r\n      {/* Messages */}\r\n      <div style={{\r\n        flex: 1,\r\n        overflowY: 'auto',\r\n        padding: theme.spacing.md,\r\n        display: 'flex',\r\n        flexDirection: 'column',\r\n        gap: theme.spacing.md,\r\n        minHeight: '300px',\r\n        maxHeight: '400px',\r\n      }}>\r\n        {loading ? (\r\n          <div style={{ textAlign: 'center', color: theme.colors.textSecondary }}>\r\n            Loading...\r\n          </div>\r\n        ) : (\r\n          <>\r\n            {messages.map((msg, idx) => (\r\n              <div\r\n                key={idx}\r\n                style={{\r\n                  display: 'flex',\r\n                  justifyContent: msg.type === 'user' ? 'flex-end' : 'flex-start',\r\n                }}\r\n              >\r\n                <div style={{\r\n                  maxWidth: '80%',\r\n                  padding: theme.spacing.sm,\r\n                  borderRadius: theme.borderRadius.md,\r\n                  background: msg.type === 'user'\r\n                    ? theme.colors.primary\r\n                    : theme.colors.gray100,\r\n                  color: msg.type === 'user'\r\n                    ? theme.colors.white\r\n                    : theme.colors.textPrimary,\r\n                  fontSize: theme.typography.fontSize.sm,\r\n                }}>\r\n                  {msg.message}\r\n                </div>\r\n              </div>\r\n            ))}\r\n            <div ref={messagesEndRef} />\r\n          </>\r\n        )}\r\n      </div>\r\n\r\n      {/* File Upload Area */}\r\n      {showFileUpload && (\r\n        <div\r\n          onDragEnter={handleDrag}\r\n          onDragLeave={handleDrag}\r\n          onDragOver={handleDrag}\r\n          onDrop={handleDrop}\r\n          style={{\r\n            margin: theme.spacing.md,\r\n            padding: theme.spacing.lg,\r\n            border: `2px dashed ${dragActive ? theme.colors.primary : theme.colors.gray300}`,\r\n            borderRadius: theme.borderRadius.md,\r\n            textAlign: 'center',\r\n            background: dragActive ? theme.colors.primaryLight : theme.colors.gray50,\r\n            cursor: 'pointer',\r\n            transition: `all ${theme.transitions.fast}`,\r\n          }}\r\n          onClick={() => fileInputRef.current?.click()}\r\n        >\r\n          <input\r\n            ref={fileInputRef}\r\n            type=\"file\"\r\n            multiple\r\n            style={{ display: 'none' }}\r\n            onChange={(e) => handleFileUpload(e.target.files)}\r\n          />\r\n          <div style={{ fontSize: '24px', marginBottom: theme.spacing.sm }}>ðŸ“Ž</div>\r\n          <div style={{ color: theme.colors.textSecondary, fontSize: theme.typography.fontSize.sm }}>\r\n            Drag and drop files here or click to browse\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      {/* Input Area */}\r\n      {!showFileUpload && currentQuestion && (\r\n        <div style={{\r\n          padding: theme.spacing.md,\r\n          borderTop: `1px solid ${theme.colors.gray200}`,\r\n        }}>\r\n          {currentQuestion.type === 'select' && currentQuestion.options ? (\r\n            <div style={{ display: 'flex', flexDirection: 'column', gap: theme.spacing.xs }}>\r\n              {currentQuestion.options.map((option, idx) => (\r\n                <Button\r\n                  key={idx}\r\n                  variant=\"outline\"\r\n                  size=\"sm\"\r\n                  onClick={() => handleOptionSelect(option)}\r\n                  style={{ width: '100%', textAlign: 'left' }}\r\n                >\r\n                  {option}\r\n                </Button>\r\n              ))}\r\n            </div>\r\n          ) : (\r\n            <form onSubmit={handleSubmit}>\r\n              <div style={{ display: 'flex', gap: theme.spacing.sm }}>\r\n                <input\r\n                  type={currentQuestion.type === 'date' ? 'date' : currentQuestion.type === 'number' ? 'number' : 'text'}\r\n                  value={inputValue}\r\n                  onChange={(e) => setInputValue(e.target.value)}\r\n                  placeholder={currentQuestion.type === 'date' ? 'DD/MM/YYYY' : 'Type your answer...'}\r\n                  style={{\r\n                    flex: 1,\r\n                    padding: theme.spacing.sm,\r\n                    border: `1px solid ${theme.colors.gray300}`,\r\n                    borderRadius: theme.borderRadius.md,\r\n                    fontSize: theme.typography.fontSize.sm,\r\n                  }}\r\n                  required={currentQuestion.required}\r\n                />\r\n                <Button type=\"submit\" variant=\"primary\" size=\"sm\">\r\n                  Send\r\n                </Button>\r\n              </div>\r\n            </form>\r\n          )}\r\n        </div>\r\n      )}\r\n\r\n      {uploading && (\r\n        <div style={{\r\n          padding: theme.spacing.sm,\r\n          textAlign: 'center',\r\n          color: theme.colors.textSecondary,\r\n          fontSize: theme.typography.fontSize.sm,\r\n        }}>\r\n          Uploading files...\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Chatbot;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}